{% extends "base.html" %}
{% block content %}

<h2>Manage Candidates</h2>

<div class="glass-box" style="margin-bottom: 2rem;">
  <form method="POST" action="{{ url_for('manage_candidates') }}" style="display: flex; flex-wrap: wrap; gap: 1rem;">
    <input type="hidden" name="action" value="add">
    <input type="text" name="name" placeholder="Candidate Name" required style="flex: 1; min-width: 180px;">
    <select name="position_id" required style="flex: 1; min-width: 180px;">
      <option value="" disabled selected>Select Position</option>
      {% for pos in positions %}
        <option value="{{ pos.id }}">{{ pos.name }}</option>
      {% endfor %}
    </select>
    <button type="submit">‚ûï Add Candidate</button>
  </form>
</div>

<hr>

<h3>Existing Candidates</h3>
<div class="glass-box" style="overflow-x:auto;">
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Position</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for c in candidates %}
      <tr>
        <td>{{ c.name }}</td>
        <td>{{ c.position }}</td>
        <td style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
          <form method="POST" action="{{ url_for('manage_candidates') }}">
            <input type="hidden" name="action" value="edit">
            <input type="hidden" name="id" value="{{ c.id }}">
            <input type="text" name="name" value="{{ c.name }}" required style="min-width: 140px;">
            <select name="position_id" required style="min-width: 140px;">
              {% for pos in positions %}
                <option value="{{ pos.id }}" {% if pos.name == c.position %}selected{% endif %}>{{ pos.name }}</option>
              {% endfor %}
            </select>
            <button type="submit">‚úèÔ∏è Update</button>
          </form>

          <form method="POST" action="{{ url_for('manage_candidates') }}" onsubmit="return confirm('Delete this candidate?')">
            <input type="hidden" name="action" value="delete">
            <input type="hidden" name="id" value="{{ c.id }}">
            <button type="submit" class="btn-danger">üóëÔ∏è Delete</button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<div style="margin-top: 2rem;">
  <a href="{{ url_for('admin_dashboard') }}">
    <button style="padding: 10px 20px;">‚Üê Back to Dashboard</button>
  </a>
</div>

{% endblock %}
