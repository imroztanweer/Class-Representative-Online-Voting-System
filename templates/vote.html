{% extends "admin_base.html" %}
{% block content %}

<div class="container fade-in"> <!-- Use layout-friendly container -->

  <div class="vote-glass-card" id="voteFormCard">
    <h2>🗳️ Cast Your Vote</h2>
    <form method="POST" action="{{ url_for('submit_vote') }}" id="voteForm" class="vote-form-ios">
      {% for position, candidates in grouped.items() %}
        <fieldset class="fieldset-ios">
          <legend>{{ position }}</legend>
          {% for candidate in candidates %}
            <label class="candidate-ios">
              <input type="radio" name="position_{{ candidate.position_id }}" value="{{ candidate.id }}" required>
              <span class="radio-custom"></span>
              <img src="{{ url_for('static', filename='avatar.png') }}" alt="avatar" class="candidate-avatar">
              {{ candidate.name }}
            </label>
          {% endfor %}
        </fieldset>
      {% endfor %}
      <button type="button" onclick="confirmVote()" class="ios-button full-width">✅ Submit Vote</button>
    </form>
  </div>

  <div class="confirmation-box glass-card hidden" id="confirmationBox">
    <h3>🔐 Confirm Your Vote</h3>
    <p>Please make sure you’ve selected your choices correctly.</p>
    <div class="confirm-actions">
      <button onclick="submitFinalVote()" class="ios-button">✅ Confirm & Submit</button>
      <button onclick="editVote()" class="ios-button secondary">🔙 Edit Choices</button>
    </div>
  </div>

  <div class="vote-success hidden" id="voteSuccess">
    <div class="emoji">🎉</div>
    <p class="message">Thank you! Your vote has been submitted.</p>
  </div>

</div>

<script>
function confirmVote() {
  document.getElementById("voteFormCard").classList.add("hidden");
  document.getElementById("confirmationBox").classList.remove("hidden");
}
function editVote() {
  document.getElementById("confirmationBox").classList.add("hidden");
  document.getElementById("voteFormCard").classList.remove("hidden");
}
function submitFinalVote() {
  document.getElementById("voteForm").submit();
  document.getElementById("confirmationBox").classList.add("hidden");
  document.getElementById("voteSuccess").classList.remove("hidden");
}
</script>

{% endblock %}
